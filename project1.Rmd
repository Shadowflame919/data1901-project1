---
title: "DATA1901 Project 1"
author: "Aitchison 490378115, Braham 490422474, Hempstead 490424010"
subtitle: "The Influence of US College Majors"
date: "University of Sydney | Semester 1 2019 | Lab Session Monday 9am | Carslaw LS 353"
output: 
  html_document:
      code_folding: hide
      css: #https://use.fontawesome.com/releases/v5.0.6/css/all.css
      df_print: paged
      fig_caption: yes
      number_sections: yes
      self_contained: yes
      theme: journal #https://bootswatch.com
      toc: yes
      toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
if (!require(ggplot2)) {
  install.packages("ggplot2")
  library(ggplot2)
}
if (!require(plotly)) {
  install.packages("plotly")
  library(plotly)
}
```

<!--200 words Executive Summary, 400 words for the IDA, and 250 words (max) for each of the Research Questions.-->

# Executive Summary

*Education. Work. Money*: three words almost guaranteed to be at the forefront of a student's mind as they contemplate their future upon leaving high school. With more and more opportunities for anyone to pursue almost any degree in any field, the inevitable question of *"Which major should I take?:"* is becoming a harder and harder choice for students across the world. <br><br>
In this research project, data from over 6.7 million college graduates in the USA has been analysed to examine key questions regarding:

* Which college major should a student take to receive the highest income?
* Which college major should a student pursue to receive the greatest prospects of employment?
* How do these "rankings" align with the popularity of these courses?

Data shows that Engineering majors often see the highest levels of income, followed by other major categories such as Business and Law. In particular, Petroleum Engineering stands over the rest of the majors with a median income of USD\$110,000, compared to a median of \$36,000. <br> <br>
Further, UNEMPLOYMENT. <br><br>
Additionally, POPULARITY. 

<br>
<br>

# Full Report

## Initial Data Analysis (IDA)

```{r loadData, include=FALSE}
gradData = read.csv("data/recent-grads.csv")
```

### Source

The data was collected from the American Community Survey 2010 - 2012 Public Use Microdata Sample Files (PUMS) at the [USA Census Website](https://www.census.gov/programs-surveys/acs/data/pums.html). It was initially wrangled by American media company [FiveThirtyEight](#fivethirty) (a part of ABC News Internet Ventures). The code used to wrangle the data can be viewed [here](https://github.com/fivethirtyeight/data/blob/master/college-majors/college-majors-rscript.R). 

### Stakeholders
According to [their website](#census), the Census Bureau produces the PUMS as an inexpensive and accessible datasource for students, social scientists, and marketing analysists. The media company *FiveThirtyEight* sorted this data and created the dataset for use in their article [The Economic Guide to Picking a College Major](#economicguide), aimed at educating students on how to best choose their own college majors. <br> <br>
While the Census Bureau is a government organisation and therefore can be assumed to be unbiased, FiveThirtyEight's article was commercially motivated, as the website runs advertisements. However, FiveThirtyEight's interpretation of the data was quite transparent, given that they provided the code and made minimal changes to the actual content of the data. The data can therefore be considered unbiased and valid. 

### Data Dictionary

```{r}
str(gradData)
```

This data consists of 20 variables (excluding "Rank" which orders the subjects by Median income), however, only xx variables are relevant for the study:

#### Data Classifications {-.tabset}

##### Major_code {-}
A unique code for each major, given by the [source](https://www.census.gov/programs-surveys/acs/data/pums.html). <br>
*Type*: Integer 
<br>
*Assessment*: Although it is a number, a factor classification would be more suitable as the codes are considered nominal (no order). 


##### Major {-}
The major's name.
<br>
*Type*: Factor 
<br>
*Assessment*: Either a character or factor classification would be suitable. 

##### Total, Men, Women {-}
Amount of total people, men, and women respectively with that major in the sample for 2010-2012.
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable. 

##### Major_category {-}
General category for that major (e.g. "Engineering").
<br>
*Type*: Factor 
<br>
*Assessment*: Suitable - allows for easy classification and plotting.

##### ShareWomen {-}
Women as a percentage of Total.
<br>
*Type*: Number 
<br>
*Assessment*: Suitable, since it is provided as a decimal (multiply by 100 if plotting percentages). 


##### Sample_size {-}
Sample size for calculating income quartiles.
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable. 

##### Employed, Full_time, Part_time {-}
Number of people employed, employed 35 hours or more per week, and employed 35 hours or less respectively.
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable. 

##### Full_time_year_round {-}
Number of people employed for at least 50 weeks per year and over 35 hours hours per week.
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable. 

##### Unemployed {-}
Number of people considered unemployed by census data.
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable. 

##### Unemployment_rate {-}
The percentage of people unemployed over (unemployed + employed).
<br>
*Type*: Number 
<br>
*Assessment*: Suitable. 

##### Median, P25th, P75th {-}
Median, 25th percentile, and 75th percentile earnings respectively for full-time, year-round workers (in USD).
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable - although income is continuous, it can be considered discrete without significantly impacting the data. 

##### College_jobs, Non_college_jobs, Low_wage_jobs {-}
Number of people with a job requiring a college degree, not requiring a college degree, and in a low-wage service job respectively.
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable. 


### Domain Knowledge

In 2012, the median personal income for the US was [\$28,213](#medi), with unemployment rates at [8.1% for 2012](#unemp). <br><br>

Recently, a research article has shown that "since the [GFC] downturn college students have turned away from the humanities and towards job-oriented degrees" [(Kopf, 2018)](#kopf), with the share of college students graduating with a degree in history dropping from 2% 2007 to 1% 2017 [(Kopf, 2018)](#kopf). This seems to reflect "a new set of student priorities, which are being formed even before they see the inside of a college classroom... Students [are] fleeing humanities and related fields specifically because they think they have poor job prospects." [(Schmidt, 2018)](#schmidt).<br><br> 

### Data Assessment

**Possible Issues**: <br>

 * The data consists of pre-summarised information, meaning that each subject (major) is a set of medians, percentages, etc. Therefore, care needs to be made in plotting and drawing conclusions. 
 * The data is categorised as an *observational study*, lacking in a control group and randomised allocation between majors. Therefore, any conclusions drawn must be treated as associativity rather than causality. 
 * The data is 7 years old, and income has not been adjusted for inflation. However, this is not a major issue considering relative comparisons are being made. 
 * The data has been pre-filtered to only include subjects below the age of 28, and therefore can be considered a sample, not a population. However, this can also be a positive in that it is more relevant to current university students.
 
<br>
**Validity**: <br>
This data, taking into account the issues above and their solutions, can be considered valid.



## New questions:
Q1: Which college majors give the highest incomes?
Sub-question: How does this take into account spread (i.e. compare 75th vs median vs 25th)

Q2: Which college majors give the highest employability (based on unemployment)?
Sub-question: How much of this employment is actually in their field / based on the degree (looking at college jobs vs non-college jobs)?

Q3: Looking at the results from Q1 and Q2, how do these "rankings" align with the popularity of these courses (based on total people = employed + unemployed)

## Research Question 1

**Which college major should a student take to receive the highest income?**

There are three variables to consider - the 25th percentile, median, and 75th percentile incomes. Additionally, it is important to consider both individual majors and major categories. Taking a summary initially shows that there is a significant range of incomes:
```{r}
summary(gradData$Median)
```
```{r warning=FALSE}
plot_ly(gradData, y=~Median/1000, color=~Major_category, type="box") %>% 
  layout(    
    yaxis = list(title = "Median income (USD$1000)"),
    xaxis = list(showticklabels = FALSE),
    title = "Median Income per Major Category")
```
Plotting the median income against major category backs up the summary - showing a large spread, centred around the median of $36,000. 
<br>

```{r warning=FALSE, include=FALSE}
# Selects top 10
gradData.head = head(gradData, n=10) 
# Creates a new data frame to be able to plot median, 25th, and 75th percentiles on the same graph 
median.df = data.frame(Major = gradData.head$Major, Major_category=gradData.head$Major_category, 
                       Income = gradData.head$Median)
p25.df = data.frame(Major = gradData.head$Major, Major_category=gradData.head$Major_category, 
                       Income = gradData.head$P25th)
p75.df = data.frame(Major = gradData.head$Major, Major_category=gradData.head$Major_category, 
                       Income = gradData.head$P75th)
gradData.head.df = rbind(median.df, p25.df, p75.df)
# For reordering the majors
score = rbind(gradData.head, gradData.head, gradData.head)
# Plots a boxplot
plot_ly(gradData.head.df, y=~Income/1000, color=~reorder(sub("AND", "\nAND",Major), -score$Median), type="box") %>%
  layout(    
    yaxis = list(
      title = "Median income (USD$1000)",
      autotick = FALSE,
      ticks = "outside",
      tick0 = 0,
      dtick = 10,
      ticklen = 3),
    xaxis = list(showticklabels = FALSE),
    title = "Top 10 Majors by Income")
```

```{r warning=FALSE, include=FALSE}
# Selects bottom 10
gradData.tail = tail(gradData, n=10)
# Creates a new data frame to be able to plot median, 25th, and 75th percentiles on the same graph
median.df = data.frame(Major = gradData.tail$Major, Major_category=gradData.tail$Major_category, 
                       Income = gradData.tail$Median)
p25.df = data.frame(Major = gradData.tail$Major, Major_category=gradData.tail$Major_category, 
                       Income = gradData.tail$P25th)
p75.df = data.frame(Major = gradData.tail$Major, Major_category=gradData.tail$Major_category, 
                       Income = gradData.tail$P75th)
gradData.tail.df = rbind(median.df, p25.df, p75.df)
# For reordering the majors
score = rbind(gradData.tail, gradData.tail, gradData.tail)
# Plots a boxplot
plot_ly(gradData.tail.df, y=~Income/1000, color=~reorder(sub("DISORDERS SCIENCES \nAND", "DISORDERS\nSCIENCES AND", sub("AND", "\nAND",Major)), -score$Median), type="box") %>%
  layout(    
    yaxis = list(
      title = "Median income (USD$1000)",
      autotick = FALSE,
      ticks = "outside",
      tick0 = 0,
      dtick = 2.5,
      ticklen = 3,
      tickwidth = 1),
    xaxis = list(showticklabels = FALSE),
    title = "Bottom 10 Majors by Income")

```

```{r fig.height=8, warning=FALSE}
# Selects top 10
gradData.head = head(gradData, n=10)
# Creates a new data frame to be able to plot median, 25th, and 75th percentiles on the same graph
median.df = data.frame(Major = gradData.head$Major, Major_category=gradData.head$Major_category, 
                       Income = gradData.head$Median)
p25.df = data.frame(Major = gradData.head$Major, Major_category=gradData.head$Major_category, 
                       Income = gradData.head$P25th)
p75.df = data.frame(Major = gradData.head$Major, Major_category=gradData.head$Major_category, 
                       Income = gradData.head$P75th)
gradData.head.df = rbind(median.df, p25.df, p75.df)
# Selects bottom 10
gradData.tail = tail(gradData, n=10)
# Creates a new data frame to be able to plot median, 25th, and 75th percentiles on the same graph
median.df = data.frame(Major = gradData.tail$Major, Major_category=gradData.tail$Major_category, 
                       Income = gradData.tail$Median)
p25.df = data.frame(Major = gradData.tail$Major, Major_category=gradData.tail$Major_category, 
                       Income = gradData.tail$P25th)
p75.df = data.frame(Major = gradData.tail$Major, Major_category=gradData.tail$Major_category, 
                       Income = gradData.tail$P75th)
gradData.tail.df = rbind(median.df, p25.df, p75.df)
score = rbind(gradData.tail, gradData.tail, gradData.tail)
# Combines the two 
gradData.combined.df =rbind(gradData.head.df, gradData.tail.df)
# Orders it
score = rbind(gradData.head, gradData.head, gradData.head, score)
# Plots a boxplot
plot_ly(gradData.combined.df, y=~Income/1000, x=~reorder(Major, -score$Median), color=~Major_category, type="box") %>%
  layout(    
    yaxis = list(
      title = "Median income (USD$1000)",
      autotick = FALSE,
      ticks = "outside",
      tick0 = 0,
      dtick = 10,
      ticklen = 3,
      tickwidth = 1,
      tickwidth = 1),
    xaxis = list(
      showticklabels = TRUE, title="",
      tickangle = 270, tickfont = list(size = 10)),
    title = "Top 10 and Bottom 10 Majors by Median Income")
```
Looking at individual majors, there are initially too many data-points to make sense of the information. Instead, ordering the data by median income, the subjects can be limited to only the top and bottom 10 majors (note that this plotted data takes into account median, 25th percentile, and 75th percentile). While 9 of the top 10 majors belong to the Engineering category, the bottom 10 majors are considerably more varied. 

<br>
```{r}
combined = gradData
median.df = data.frame(Major = combined$Major, Major_category=strtrim(combined$Major_category, 45), 
                       Income = combined$Median)
p25.df = data.frame(Major = combined$Major, Major_category=strtrim(combined$Major_category, 45), 
                       Income = combined$P25th)
p75.df = data.frame(Major = combined$Major, Major_category=strtrim(combined$Major_category, 45), 
                       Income = combined$P75th)
combined.df = rbind(median.df, p25.df, p75.df)
ggplotly(ggplot(combined.df, aes(x=Income/1000, fill=Major_category)) + geom_density(alpha=0.2) + facet_wrap(~Major_category) +
           xlab("Income (USD$1000)") + ylab("Density") + labs(title="Income Density per Major Category") + theme_minimal() + theme(legend.position="none", strip.text.x = element_text(size = 7)))

combined = rbind(gradData[gradData$Major_category=="Engineering",],
                 gradData[gradData$Major_category=="Education",], gradData[gradData$Major_category=="Business",])
median.df = data.frame(Major = combined$Major, Major_category=combined$Major_category, 
                       Income = combined$Median)
p25.df = data.frame(Major = combined$Major, Major_category=combined$Major_category, 
                       Income = combined$P25th)
p75.df = data.frame(Major = combined$Major, Major_category=combined$Major_category, 
                       Income = combined$P75th)
combined.df = rbind(median.df, p25.df, p75.df)
ggplotly(ggplot(combined.df, aes(x=Income/1000, fill=Major_category)) + geom_density(alpha=0.2) +
           xlab("Income (USD$1000)") + ylab("Density") + labs(fill="Major Category", title="Income Density per Major Category (Selection)") + theme_minimal())
```

Examining the density estimation of a selection of major categories, again Engineering appears to have significantly higher incomes compared to other categories. However, the estimation shows that the spread is also significantly larger, with a portion of the income falling within the range of the lowest majors. This is contrasted with Education, where the range is confined to ~$25,000.  
```{r}
# Coefficient of Variation for the Engineering sample's incomes
paste("Coefficient of Variation for Engineering:", sd(combined.df[combined.df$Major_category=="Engineering",]$Income)/
  mean(combined.df[combined.df$Major_category=="Engineering",]$Income)) 
# Coefficient of Variation for the Education sample's incomes
paste("Coefficient of Variation for Education:", sd(combined.df[combined.df$Major_category=="Education",]$Income)/
  mean(combined.df[combined.df$Major_category=="Education",]$Income)) 
```
This is re-iterated by the coefficient of variation for Engineering being over 150% of Education's. 
<br> <br>
**Summary**: <br>
The data shows that Engineering incomes can far exceed those in other categories, with Petroleum Engineering in particular being significantly higher than the other majors. Indeed, the separation of Petroleum Engineering from the other top 10 median incomes is comparable to the separation of the top 10 from the bottom 10. However, Engineering incomes overall have a significantly larger spread than the other categories, implying a volatility either between majors or within the industries themselves. Nevertheless, students seeking high incomes may be best suited to look towards Engineering fields. 
<br><br>

## Research Question 2
**Which college major should a student pursue to see the greatest prospects for employment?** <br>
Insert text and analysis. 

```{r}
percentCollege = gradData$College_jobs/(gradData$College_jobs+gradData$Non_college_jobs+gradData$Low_wage_jobs)
ggplot(gradData, aes(x=factor(Major_category), y=percentCollege)) + 
  geom_boxplot(aes(fill = factor(Major_category))) +
  theme(axis.text.x = element_blank(), axis.title.x = element_blank(), axis.ticks.x = element_blank()) +
  labs(fill = "Major Category", title="Percent College Jobs per Major Category") + 
  ylab("Percentage of Jobs as College Jobs")
```
<br>How much of this employment is actually in their field / based on the degree (looking at college jobs vs non-college jobs)?

<br>

## Research Question 3

*Looking at the results from Q1 and Q2, how do these "rankings" align with the popularity of these courses?* (based on total people = employed + unemployed)

Insert text and analysis. 

Summary: 

<br>


# References

<a name="unemp"></a> 
Bureau of Labor Statistics. (2019). *Labor Force Statistics from the Current Population Survey, 2012 (LNU04000000)* [Data set]. Retrieved from [http://data.bls.gov](http://data.bls.gov). <br> <br>
<a name="economicguide"></a>
Casselman, B. (2014, September 12). The Economic Guide to Picking a College Major. *FiveThirtyEight*. Retrieved from [https://fivethirtyeight.com/features/the-economic-guide-to-picking-a-college-major/](https://fivethirtyeight.com/features/the-economic-guide-to-picking-a-college-major/). <br><br>
<a name="fivethirty"></a>
FiveThirtyEight. (2014). *College Majors 2010-2012  (Recent Grads)* [Data set]. Retrieved from Github; [https://github.com/fivethirtyeight/data/tree/master/college-majors](https://github.com/fivethirtyeight/data/tree/master/college-majors). <br> <br>
<a name="kopf"></a>
Kopf, D. (2018, August 29). The 2008 financial crisis completely changed what majors students choose. *Quartz*. Retrieved from [https://qz.com/1370922/the-2008-financial-crisis-completely-changed-what-majors-students-choose/](https://qz.com/1370922/the-2008-financial-crisis-completely-changed-what-majors-students-choose/). <br><br>
<a name="schmidt"></a>
Schmidt, B. (2018, August 3). The Humanities Are in Crisis. *The Atlantic*. Retrieved from [https://www.theatlantic.com/ideas/archive/2018/08/the-humanities-face-a-crisisof-confidence/567565/](https://www.theatlantic.com/ideas/archive/2018/08/the-humanities-face-a-crisisof-confidence/567565/). <br><br>
<a name="census"></a>
US. Bureau of the Census. (2018). *Public Use Microdata Samples (PUMS) Documentation*. Retrieved from [https://www.census.gov/programs-surveys/acs/technical-documentation/pums.html](https://www.census.gov/programs-surveys/acs/technical-documentation/pums.html). <br><br>
<a name="medi"></a> 
U.S. Bureau of the Census. (2017). *Real Median Personal Income in the United States, 2012 (MEPAINUSA672N)* [Data set]. Retrieved from FRED, Federal Reserve Bank of St. Louis; [https://fred.stlouisfed.org/series/MEPAINUSA672N](https://fred.stlouisfed.org/series/MEPAINUSA672N). <br><br>


```{r}
sessionInfo()
```


