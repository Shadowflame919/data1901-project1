---
title: "DATA1901 Project 1"
author: "490378115, 490422474, XXXXXXXXX"
subtitle: "The Influence of US College Majors"
date: "University of Sydney | Semester 1 | March 2019 \n "
output: 
  html_document:
      code_folding: hide
      css: #https://use.fontawesome.com/releases/v5.0.6/css/all.css
      df_print: paged
      fig_caption: yes
      number_sections: yes
      self_contained: yes
      theme: journal #https://bootswatch.com
      toc: yes
      toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
if (!require(ggplot2)) {
  install.packages("ggplot2")
  library(ggplot2)
}
if (!require(plotly)) {
  install.packages("plotly")
  library(plotly)
}
```

<!--We suggest 400 words (max) for the Executive Summary, 200 words (max) for the IDA, and 250 words (max) for each of the Research Questions.-->

# Executive Summary

*Something catchy!!!!*
It is important to note that this is an observational study - only association can be inferred, not causation. 
<br>
<br>

# Full Report

## Initial Data Analysis (IDA)

```{r loadData}
gradData = read.csv("data/recent-grads.csv")
```

### Source

The data was collected from the American Community Survey 2010 - 2012 Public Use Microdata Sample Files (PUMS) at the [USA Census Website](https://www.census.gov/programs-surveys/acs/data/pums.html). It was initially wrangled by American media company [FiveThirtyEight](https://github.com/fivethirtyeight/data/tree/master/college-majors) (a part of ABC News Internet Ventures). The code used to wrangle the data can be viewed [here](https://github.com/fivethirtyeight/data/blob/master/college-majors/college-majors-rscript.R). 

### Stakeholders
According to [their website](https://www.census.gov/programs-surveys/acs/technical-documentation/pums.html), the Census Bureau produces the PUMS as an inexpensive and accessible datasource for students, social scientists, and marketing analysists. The media company *FiveThirtyEight* sorted this data and created the dataset for use in their article [The Economic Guide to Picking a College Major](https://www.census.gov/programs-surveys/acs/technical-documentation/pums.html), aimed at educating students on how to best choose their own college majors. <br>
While the Census Bureau is a government organisation and therefore can be assumed to be unbiased, FiveThirtyEight's article was commercially motivated, as the website runs advertisements. However, FiveThirtyEight's interpretation of the data was quite transparent, given that they provided the code and made minimal changes to the actual content of the data. The data can therefore be considered unbiased and valid. 

### Data Dictionary

```{r}
# View the structure of the data:
str(gradData)
```

This data consists of 20 variables (excluding "Rank" which orders the subjects by Median income). 

#### Major_code {-}
A unique code for each major, given by the [source](https://www.census.gov/programs-surveys/acs/data/pums.html). <br>
*Type*: Integer 
<br>
*Assessment*: Although it is a number, a factor classification would be more suitable as the codes are considered nominal (no order). 


#### Major {-}
The major's name.
<br>
*Type*: Factor 
<br>
*Assessment*: Either a character or factor classification would be suitable. 

#### Total, Men, Women {-}
Amount of total people, men, and women respectively with that major in the sample for 2010-2012.
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable. 

#### Major_category {-}
General category for that major (e.g. "Engineering").
<br>
*Type*: Factir 
<br>
*Assessment*: Suitable - allows for easy classification and plotting.

#### ShareWomen {-}
Women as a percentage of Total.
<br>
*Type*: Number 
<br>
*Assessment*: Suitable, since it is provided as a decimal (multiply by 100 if plotting percentages). 


#### Sample_size {-}
Sample size for calculating income quartiles.
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable. 

#### Employed, Full_time, Part_time {-}
Number of people employed, employed 35 hours or more per week, and employed 35 hours or less respectively.
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable. 

#### Full_time_year_round {-}
Number of people employed for at least 50 weeks per year and over 35 hours hours per week.
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable. 

#### Unemployed {-}
Number of people considered unemployed by census data.
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable. 

#### Unemployment_rate {-}
The percentage of people unemployed over (unemployed + employed).
<br>
*Type*: Number 
<br>
*Assessment*: Suitable. 

#### Median, P25th, P75th {-}
Median, 25th percentile, and 75th percentile earnings respectively for full-time, year-round workers (in USD).
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable - although income is continuous, it can be considered discrete without significantly impacting the data. 

#### College_jobs, Non_college_jobs, Low_wage_jobs {-}
Number of people with a job requiring a college degree, not requiring a college degree, and in a low-wage service job respectively.
<br>
*Type*: Integer 
<br>
*Assessment*: Suitable. 


### Data Assessment

**Possible Issues**: <br>

 * Some values in the dataset are blank, and therefore need to be removed prior to analysis.
 * The data consists of pre-summarised information, meaning that each subject (major) is a set of medians, percentages, etc. Therefore, care needs to be made in plotting and drawing conclusions. 
 * The data is categorised as an *observational study*, lacking in a control group and randomised allocation between majors. Therefore, any conclusions drawn must be treated as associativity rather than causality. 
 * Income has not been adjusted for inflation, however, this is not a major issue considering we are concerned with the relative comparisons. 
 * Data has been pre-filtered to only include subjects below the age of 28, and therefore can be considered a sample, not a population. However, this can also be a positive in that it is more relevant to current university students.
 
<br>
**Validity**: <br>
This data, taking into account the issues above and their solutions, can be considered valid.

### Data Wrangling
"Military Technologies" major has no data for college-level jobs, therefore we are removing it for this analysis to prevent errors in plotting.
```{r}
# Remove rows with blank values 
gradData = gradData[gradData$Major != "MILITARY TECHNOLOGIES",]
``` 

<br>

## New questions:
Q1: Which college majors give the highest incomes?
Sub-question: How does this take into account spread (i.e. compare 75th vs median vs 25th)

Q2: Which college majors give the highest employability (based on unemployment)?
Sub-question: How much of this employment is actually in their field / based on the degree (looking at college jobs vs non-college jobs)?

Q3: Which college majors pay the most per time worked (looking at % full time)? 

Q3 (alternative): Looking at the results from Q1 and Q2, how do these "rankings" align with the popularity of these courses (based on total people = employed + unemployed)

## Research Question 1

**Which college major should a student take to receive the highest income?**

There are three variables to consider when looking at income - the 25th percentile, median, and 75th percentile. Additionally, it is important to consider whether to look at individual majors or major categories. Before plotting data, taking a summary initially tells us that there is a significant range of incomes:
```{r}
summary(gradData$Median)
```
Plotting the median income against major category, we get:
```{r warning=FALSE}
plot_ly(gradData, y=~Median/1000, color=~Major_category, type="box") %>% 
  layout(    
    yaxis = list(title = "Median income (USD$1000)"),
    xaxis = list(showticklabels = FALSE),
    title = "Median Income per Major Category")
```
This backs up the summary, as we see a large spread, centred around the median of $36,000. 
<br>
Looking now at individual majors, we initially have too many datapoints to make sense of the information. Instead, ordering the data by median income, we can limit the subjects to only the top and bottom 10 majors (note that this plotted data takes into account median, 25th percentile, and 75th percentile):

```{r warning=FALSE, include=FALSE}
# Selects top 10
gradData.head = head(gradData, n=10) 
# Creates a new data frame to be able to plot median, 25th, and 75th percentiles on the same graph 
median.df = data.frame(Major = gradData.head$Major, Major_category=gradData.head$Major_category, 
                       Income = gradData.head$Median)
p25.df = data.frame(Major = gradData.head$Major, Major_category=gradData.head$Major_category, 
                       Income = gradData.head$P25th)
p75.df = data.frame(Major = gradData.head$Major, Major_category=gradData.head$Major_category, 
                       Income = gradData.head$P75th)
gradData.head.df = rbind(median.df, p25.df, p75.df)
# For reordering the majors
score = rbind(gradData.head, gradData.head, gradData.head)
# Plots a boxplot
plot_ly(gradData.head.df, y=~Income/1000, color=~reorder(sub("AND", "\nAND",Major), -score$Median), type="box") %>%
  layout(    
    yaxis = list(
      title = "Median income (USD$1000)",
      autotick = FALSE,
      ticks = "outside",
      tick0 = 0,
      dtick = 10,
      ticklen = 3,
      tickwidth = 1),
    xaxis = list(showticklabels = FALSE),
    title = "Top 10 Majors by Income")
```

```{r warning=FALSE, include=FALSE}
# Selects bottom 10
gradData.tail = tail(gradData, n=10)
# Creates a new data frame to be able to plot median, 25th, and 75th percentiles on the same graph
median.df = data.frame(Major = gradData.tail$Major, Major_category=gradData.tail$Major_category, 
                       Income = gradData.tail$Median)
p25.df = data.frame(Major = gradData.tail$Major, Major_category=gradData.tail$Major_category, 
                       Income = gradData.tail$P25th)
p75.df = data.frame(Major = gradData.tail$Major, Major_category=gradData.tail$Major_category, 
                       Income = gradData.tail$P75th)
gradData.tail.df = rbind(median.df, p25.df, p75.df)
# For reordering the majors
score = rbind(gradData.tail, gradData.tail, gradData.tail)
# Plots a boxplot
plot_ly(gradData.tail.df, y=~Income/1000, color=~reorder(sub("DISORDERS SCIENCES \nAND", "DISORDERS\nSCIENCES AND", sub("AND", "\nAND",Major)), -score$Median), type="box") %>%
  layout(    
    yaxis = list(
      title = "Median income (USD$1000)",
      autotick = FALSE,
      ticks = "outside",
      tick0 = 0,
      dtick = 2.5,
      ticklen = 3,
      tickwidth = 1),
    xaxis = list(showticklabels = FALSE),
    title = "Bottom 10 Majors by Income")

```

```{r warning=FALSE}
# Selects top 5
gradData.head = head(gradData, n=10)
# Creates a new data frame to be able to plot median, 25th, and 75th percentiles on the same graph
median.df = data.frame(Major = gradData.head$Major, Major_category=gradData.head$Major_category, 
                       Income = gradData.head$Median)
p25.df = data.frame(Major = gradData.head$Major, Major_category=gradData.head$Major_category, 
                       Income = gradData.head$P25th)
p75.df = data.frame(Major = gradData.head$Major, Major_category=gradData.head$Major_category, 
                       Income = gradData.head$P75th)
gradData.head.df = rbind(median.df, p25.df, p75.df)
# Selects bottom 5
gradData.tail = tail(gradData, n=10)
# Creates a new data frame to be able to plot median, 25th, and 75th percentiles on the same graph
median.df = data.frame(Major = gradData.tail$Major, Major_category=gradData.tail$Major_category, 
                       Income = gradData.tail$Median)
p25.df = data.frame(Major = gradData.tail$Major, Major_category=gradData.tail$Major_category, 
                       Income = gradData.tail$P25th)
p75.df = data.frame(Major = gradData.tail$Major, Major_category=gradData.tail$Major_category, 
                       Income = gradData.tail$P75th)
gradData.tail.df = rbind(median.df, p25.df, p75.df)
score = rbind(gradData.tail, gradData.tail, gradData.tail)
# Combines the two 
gradData.combined.df =rbind(gradData.head.df, gradData.tail.df)
# Orders it
score = rbind(gradData.head, gradData.head, gradData.head, score)
# Plots a boxplot
plot_ly(gradData.combined.df, y=~Income/1000, x=~reorder(Major, -score$Median), color=~Major_category, type="box") %>%
  layout(    
    yaxis = list(
      title = "Median income (USD$1000)",
      autotick = FALSE,
      ticks = "outside",
      tick0 = 0,
      dtick = 10,
      ticklen = 3,
      tickwidth = 1),
    xaxis = list(showticklabels = FALSE, title=""),
    title = "Top 10 and Bottom 10 Majors by Median Income")
```
While 9 of the top 10 majors belong to the Engineering category, the bottom 10 majors are considerably more varied, consisting of Biologoy, Business, Education, Health, Humanities & Liberal Arts, and Psychology & Social Work. 
<br>

**Summary**: <br>
From this data, it can be inferred that Engineering incomes far exceed that seen in the other categories. Petroleum Engineering in particular is significantly higher than the other majors. Indeed, the separation of Petroleum Engineering from the other top 10 median incomes is comparable to the separation of the top 10 from the bottom 10. However, an important distinction must be made in that the observational nature of this data cannot imply that majoring in Engineering will *cause* one to have a larger income, rather, it can only imply the association between the two. <br>
<br>

## Research Question 2
**Which college major should a student pursue to see the greatest prospects for employment?** <br>
Insert text and analysis. 

```{r}
percentCollege = gradData$College_jobs/(gradData$College_jobs+gradData$Non_college_jobs+gradData$Low_wage_jobs)
ggplot(gradData, aes(x=factor(Major_category), y=percentCollege)) + 
  geom_boxplot(aes(fill = factor(Major_category))) +
  theme(axis.text.x = element_blank(), axis.title.x = element_blank(), axis.ticks.x = element_blank()) +
  labs(fill = "Major Category", title="Percent College Jobs per Major Category") + 
  ylab("Percentage of Jobs as College Jobs")
```
<br>  much of this employment is actually in their field / based on the degree (looking at college jobs vs non-college jobs)?

<br>

## Research Question 3

*Looking at the results from Q1 and Q2, how do these "rankings" align with the popularity of these courses?* (based on total people = employed + unemployed)

Insert text and analysis. 

Summary: 

<br>

# Conclusions

Insert text.

<br>

```{r}
sessionInfo()
```


# References

Style: APA 
Major categories were sourced from ["What's It Worth?: The Economic Value of College Majors." Georgetown University Center on Education and the Workforce, 2011](http://cew.georgetown.edu/whatsitworth). 

<br>

# Personal reflection on group work

- The way I contributed was ...
- What I learnt about group work was ... 

<br>

